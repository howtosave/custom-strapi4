"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[5895],{27948:(fe,D,a)=>{a.r(D),a.d(D,{SettingsPage:()=>Et,default:()=>Rn});var e=a(32735),E=a(484),s=a(5141),ne=a(11856),V=a(5636),Le=a(99357),Se=a(55187),Ce=a(2139),$e=a(84968),X=a(16540),F=a(9808),P=a(78330),Z=a(95602),ge=a(90662),U=a(44526),de=a(14983),Ye=a(82372),Qe=a(88677),Ge=a.n(Qe),Pe=a(60216),f=a.n(Pe),we=a(69898),he=a(20763),Je=a(59290),ue=a.n(Je),Y=a(23101),re=a.n(Y),_e=a(49415);const je={currentStep:void 0},He=(m=je,d)=>(0,_e.default)(m,c=>{switch(d.type){case"GO_TO":{c.currentStep=d.to;break}default:return c}});var pe=a(4122);const et={localImage:void 0},se=(m=et,d)=>(0,_e.default)(m,c=>{switch(d.type){case"SET_LOCAL_IMAGE":{c.localImage=d.value;break}default:return c}}),Ue=({onChangeLogo:m,customLogo:d,goTo:c,Component:v,modalTitle:u,next:R,prev:M,currentStep:T})=>{const[{localImage:C},A]=(0,e.useReducer)(se,et),{formatMessage:te}=(0,V.useIntl)(),ae=nt=>{A({type:"SET_LOCAL_IMAGE",value:nt})},Xe=()=>{c(null)};return T?e.createElement(pe.ModalLayout,{labelledBy:"modal",onClose:Xe},e.createElement(pe.ModalHeader,null,e.createElement(Z.Typography,{fontWeight:"bold",as:"h2",id:"modal"},te(u))),e.createElement(v,{setLocalImage:ae,goTo:c,next:R,prev:M,onClose:Xe,asset:C||d,onChangeLogo:m})):null};Ue.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},Ue.propTypes={Component:f().elementType,currentStep:f().string,customLogo:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}),goTo:f().func.isRequired,modalTitle:f().shape({id:f().string,defaultMessage:f().string}),next:f().string,onChangeLogo:f().func.isRequired,prev:f().string};const x=Ue,j=750,W=100,ie=["image/jpeg","image/png","image/svg+xml"];var q=a(81700),G=a(27635),Q=a(19615),_=a(19192),H=a(78752),oe=a(20001),Ne=a(22795),Ve=a.n(Ne),Ke=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const rt={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},ke={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},w=m=>new Promise(d=>{const c=new FileReader;c.onload=()=>{const v=new Image;v.onload=function(){d({width:v.width,height:v.height})},v.src=c.result},c.readAsDataURL(m)}),k=(m,d)=>({ext:m.name.split(".").pop(),size:m.size/1e3,name:m.name,url:URL.createObjectURL(m),rawFile:m,width:d.width,height:d.height}),z=m=>Ke(void 0,null,function*(){let d;if(!ie.includes(m.type))throw d=new Error("File format"),d.displayMessage=rt,d;const v=yield w(m);if(!(v.width<=j&&v.height<=j))throw d=new Error("File sizing"),d.displayMessage=ke,d;const R=k(m,v);if(!(R.size<=W))throw d=new Error("File sizing"),d.displayMessage=ke,d;return R});var le=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const xe=(0,Q.default)(oe.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ze=({setLocalImage:m,goTo:d,next:c,onClose:v})=>{const{formatMessage:u}=(0,V.useIntl)(),[R,M]=(0,e.useState)(!1),[T,C]=(0,e.useState)(void 0),A=(0,e.useRef)(null),te=()=>M(!0),ae=()=>M(!1),Xe=bt=>{bt.preventDefault(),A.current.click()},nt=()=>le(void 0,null,function*(){ae();const bt=A.current.files[0];if(!!bt)try{const gt=yield z(bt);m(gt),d(c)}catch(gt){if(gt.displayMessage)C(u(gt.displayMessage,{size:W,dimension:j})),A.current.focus();else throw gt}}),dt=()=>R?"primary500":T?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(F.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(oe.Field,{name:"logo-upload",error:T},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(ge.Stack,{spacing:2},e.createElement(_.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:R?"primary100":"neutral100",borderColor:dt(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:te,onDragLeave:ae},e.createElement(H.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:Ve(),"aria-hidden":!0}),e.createElement(F.Box,{paddingTop:3,paddingBottom:5},e.createElement(Z.Typography,{variant:"delta",as:"span"},u({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(xe,{accept:ie,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:nt,ref:A,id:"logo-upload"}),e.createElement(U.Button,{type:"button",onClick:Xe},u({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(F.Box,{paddingTop:6},e.createElement(Z.Typography,{variant:"pi",textColor:"neutral600"},u({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:W,dimension:j})))),e.createElement(oe.FieldError,null)))))),e.createElement(pe.ModalFooter,{startActions:e.createElement(U.Button,{onClick:v,variant:"tertiary"},u({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ze.defaultProps={next:null},ze.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const qe=ze;var J=a(37178),ye=a(43653),Ae=a.n(ye),b=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const qt=m=>b(void 0,null,function*(){try{const d=yield Ae().get(m,{responseType:"blob",timeout:8e3});return new File([d.data],d.config.url,{type:d.headers["content-type"]})}catch(d){throw d.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},d}});var kn=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const Tt=({goTo:m,next:d,onClose:c,setLocalImage:v})=>{const{formatMessage:u}=(0,V.useIntl)(),[R,M]=(0,e.useState)(""),[T,C]=(0,e.useState)(null),A=ae=>{M(ae.target.value)},te=()=>kn(void 0,null,function*(){try{const ae=yield qt(R),Xe=yield z(ae);v(Xe),m(d)}catch(ae){if(ae.displayMessage)C(u(ae.displayMessage,{size:W,dimension:j}));else throw ae}});return e.createElement("form",{onSubmit:ae=>{ae.preventDefault(),te()}},e.createElement(F.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(J.TextInput,{label:u({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:T,onChange:A,value:R,name:"logo-url"})),e.createElement(pe.ModalFooter,{startActions:e.createElement(U.Button,{onClick:c,variant:"tertiary"},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(U.Button,{type:"submit"},u({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};Tt.defaultProps={next:null},Tt.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const _t=Tt,yt=({setLocalImage:m,goTo:d,next:c,onClose:v})=>{const{formatMessage:u}=(0,V.useIntl)();return e.createElement(q.TabGroup,{label:u({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(F.Box,{paddingLeft:8,paddingRight:8},e.createElement(q.Tabs,null,e.createElement(q.Tab,null,u({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(q.Tab,null,u({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(G.Divider,null)),e.createElement(q.TabPanels,null,e.createElement(q.TabPanel,null,e.createElement(qe,{onClose:v,setLocalImage:m,goTo:d,next:c})),e.createElement(q.TabPanel,null,e.createElement(_t,{onClose:v,setLocalImage:m,goTo:d,next:c}))))};yt.defaultProps={next:null},yt.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const en=yt;var st=a(31998);const At=({asset:m})=>{const{formatMessage:d}=(0,V.useIntl)();return e.createElement(st.Card,null,e.createElement(st.CardHeader,null,e.createElement(st.CardAsset,{size:"S",src:m.url})),e.createElement(st.CardBody,null,e.createElement(st.CardContent,null,e.createElement(st.CardTitle,null,m.name),e.createElement(st.CardSubtitle,null,`${m.ext.toUpperCase()} - ${m.width}\u2715${m.height}`)),e.createElement(st.CardBadge,null,d({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};At.propTypes={asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired};const Bt=At,vt=({onClose:m,asset:d,prev:c,next:v,goTo:u,setLocalImage:R,onChangeLogo:M})=>{const{formatMessage:T}=(0,V.useIntl)(),C=()=>{R(void 0),u(c)},A=()=>{M(d),u(v)};return e.createElement(e.Fragment,null,e.createElement(F.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(_.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(_.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(Z.Typography,{variant:"pi",fontWeight:"bold"},T({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(Z.Typography,{variant:"pi",textColor:"neutral500"},T({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(U.Button,{onClick:C,variant:"secondary"},T({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(F.Box,{maxWidth:(0,E.pxToRem)(180)},e.createElement(Bt,{asset:d}))),e.createElement(pe.ModalFooter,{startActions:e.createElement(U.Button,{onClick:m,variant:"tertiary"},T({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(U.Button,{onClick:A},T({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};vt.defaultProps={next:null,prev:null},vt.propTypes={goTo:f().func.isRequired,asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired,next:f().string,onClose:f().func.isRequired,onChangeLogo:f().func.isRequired,prev:f().string,setLocalImage:f().func.isRequired};const Ot={upload:{Component:en,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:vt,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},wt=({customLogo:m,defaultLogo:d,onChangeLogo:c,onResetMenuLogo:v})=>{const[{currentStep:u},R]=(0,e.useReducer)(He,je),{Component:M,next:T,prev:C,modalTitle:A}=Ot[u]||{},{formatMessage:te}=(0,V.useIntl)(),ae=Xe=>{R({type:"GO_TO",to:Xe})};return e.createElement(e.Fragment,null,e.createElement(we.CarouselInput,{label:te({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"}),selectedSlide:0,hint:te({id:"Settings.application.customization.carousel-hint",defaultMessage:"Change the admin panel logo (Max dimension: {dimension}x{dimension}, Max file size: {size}KB)"},{size:W,dimension:j}),previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:(m==null?void 0:m.name)||"logo.png",actions:e.createElement(we.CarouselActions,null,e.createElement(he.IconButton,{onClick:()=>ae(m?"pending":"upload"),label:te({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(ue(),null)}),m&&e.createElement(he.IconButton,{onClick:v,label:te({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(re(),null)}))},e.createElement(we.CarouselSlide,{label:te({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(F.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:(m==null?void 0:m.url)||d,alt:te({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(x,{Component:M,currentStep:u,onChangeLogo:c,customLogo:m,goTo:ae,next:T,prev:C,modalTitle:A}))};wt.defaultProps={customLogo:null},wt.propTypes={customLogo:f().shape({url:f().string,name:f().string}),defaultLogo:f().string.isRequired,onChangeLogo:f().func.isRequired,onResetMenuLogo:f().func.isRequired};const jt=wt,Rt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}}},on=(m=Rt,d)=>(0,_e.default)(m,c=>{switch(d.type){case"SET_CUSTOM_MENU_LOGO":{c.menuLogo.display=d.value,c.menuLogo.submit.rawFile=d.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{c.menuLogo.display=null,c.menuLogo.submit={rawFile:null,isReset:!0};break}default:return c}});var an=a(86349),Nt=a.n(an);const Dt=(m,d)=>Nt()(m,{menuLogo:{display:d.menuLogo}}),xt=(0,e.forwardRef)(({projectSettingsStored:m},d)=>{const{formatMessage:c}=(0,V.useIntl)(),{trackUsage:v}=(0,E.useTracking)(),{logos:{menu:u}}=(0,Se.um)(),[{menuLogo:R},M]=(0,e.useReducer)(on,Rt,()=>Dt(Rt,m)),T=A=>{M({type:"SET_CUSTOM_MENU_LOGO",value:A})},C=()=>{v("didClickResetLogo"),M({type:"RESET_CUSTOM_MENU_LOGO"})};return(0,e.useImperativeHandle)(d,()=>({getValues:()=>({menuLogo:R.submit})})),e.createElement(F.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(Z.Typography,{variant:"delta",as:"h3"},c({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(P.Grid,{paddingTop:4},e.createElement(P.GridItem,{col:6,s:12},e.createElement(jt,{onChangeLogo:T,customLogo:R.display,defaultLogo:u.default,onResetMenuLogo:C}))))});xt.defaultProps={projectSettingsStored:null},xt.propTypes={projectSettingsStored:f().shape({menuLogo:f().shape({url:f().string,name:f().string})})};const rn=null;var ct=a(49986),Zn=a(48344),Mt=a.n(Zn),Gn=Object.defineProperty,it=Object.defineProperties,Hn=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,ln=Object.prototype.propertyIsEnumerable,cn=(m,d,c)=>d in m?Gn(m,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):m[d]=c,pt=(m,d)=>{for(var c in d||(d={}))sn.call(d,c)&&cn(m,c,d[c]);if(Wt)for(var c of Wt(d))ln.call(d,c)&&cn(m,c,d[c]);return m},Kn=(m,d)=>it(m,Hn(d));const $t=m=>Mt()(m,(d,c,v)=>{c&&c.url?d[v]=Kn(pt({},c),{url:(0,E.prefixFileUrlWithBackendUrl)(c.url)}):d[v]=c},{});var Lt=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const dn=()=>Lt(void 0,null,function*(){const{data:m}=yield axiosInstance.get("/admin/project-settings");return prefixAllUrls(m)}),un=m=>Lt(void 0,null,function*(){const{data:d}=yield ct.be.post("/admin/project-settings",m);return $t(d)}),Ut=m=>{const d=new FormData;return Object.entries(m).forEach(([c,v])=>{v&&v.rawFile instanceof File&&d.append(c,v.rawFile),v&&v.isReset&&d.append(c,null)}),d};var Vt=(m,d,c)=>new Promise((v,u)=>{var R=C=>{try{T(c.next(C))}catch(A){u(A)}},M=C=>{try{T(c.throw(C))}catch(A){u(A)}},T=C=>C.done?v(C.value):Promise.resolve(C.value).then(R,M);T((c=c.apply(m,d)).next())});const Xn=[{action:"admin::project-settings.update",subject:null}],gn=()=>{const m=(0,e.useRef)(),d=(0,E.useNotification)(),{trackUsage:c}=(0,E.useTracking)(),{formatMessage:v}=(0,V.useIntl)(),u=(0,$e.useQueryClient)();(0,E.useFocusWhenNavigate)();const R=(0,E.useAppInfos)(),{appName:M,appVersion:T,nodeVersion:C,strapiVersion:A}=R,{updateProjectSettings:te}=(0,Se.um)(),ae=(0,$e.useMutation)(nt=>un(nt),{onSuccess(nt){return Vt(this,arguments,function*({menuLogo:dt}){yield u.invalidateQueries("project-settings",{refetchActive:!0}),te({menuLogo:dt==null?void 0:dt.url})})}}),Xe=()=>{const nt=m.current.getValues(),dt=Ut(nt);ae.mutate(dt,{onError(){d({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(ne.Layout,null,e.createElement(E.SettingsPageTitle,{name:"Application"}),e.createElement(X.Main,null,e.createElement(ne.HeaderLayout,{title:v({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:v({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:e.createElement(U.Button,{onClick:Xe,startIcon:e.createElement(Ge(),null)},v({id:"global.save",defaultMessage:"Save"}))}),e.createElement(ne.ContentLayout,null,e.createElement(ge.Stack,{spacing:6},e.createElement(F.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(ge.Stack,{spacing:5},e.createElement(Z.Typography,{variant:"delta",as:"h3"},v({id:"global.details",defaultMessage:"Details"})),e.createElement(P.Grid,{paddingTop:1},e.createElement(P.GridItem,{col:6,s:12},e.createElement(Z.Typography,{variant:"sigma",textColor:"neutral600"},"Server Version"),e.createElement(Z.Typography,{as:"p"},"v",T))),e.createElement(F.Box,{paddingTop:1},e.createElement(Z.Typography,{variant:"sigma",textColor:"neutral600"},v({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(Z.Typography,{as:"p"},C,"/",A))))))))};var Yn=a(3704),fn=a.n(Yn);const yn=m=>fn()(m,c=>c.links).map(c=>(0,Ce.ot)(c.Component,c.to,c.exact||!1)),Cn=m=>m.filter(d=>!d.links.every(c=>c.isDisplayed===!1));var kt=a(21930),Qn=a(72975),ve=a.n(Qn),tt=function(d,c,v){return new Promise(function(u,R){var M=function(te){try{C(v.next(te))}catch(ae){R(ae)}},T=function(te){try{C(v.throw(te))}catch(ae){R(ae)}},C=function(te){return te.done?u(te.value):Promise.resolve(te.value).then(M,T)};C((v=v.apply(d,c)).next())})},zt=function(){return window&&window.strapi&&window.strapi.isEE?a(94775).Z:a(12763).Z}(),En=function(){return window&&window.strapi&&window.strapi.isEE?a(94289).Z:a(55520).Z}(),Zt=[{Component:function(){return{default:En}},to:"/settings/roles",exact:!0},{Component:function(){return{default:zt}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:zt}},to:"/settings/roles/new",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,a.e(2544).then(a.bind(a,5324));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/roles/:id",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,a.e(5199).then(a.bind(a,492));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/users",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,a.e(4263).then(a.bind(a,45480));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/users/:id",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([a.e(4715),a.e(5162)]).then(a.bind(a,18568));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/webhooks/create",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([a.e(4715),a.e(5162)]).then(a.bind(a,3160));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,a.e(4121).then(a.bind(a,63375));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/webhooks",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,a.e(8056).then(a.bind(a,44445));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/api-tokens",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([a.e(7379),a.e(7187),a.e(4299)]).then(a.bind(a,52988));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return tt(this,null,ve().mark(function d(){var c;return ve().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([a.e(7379),a.e(7187),a.e(92)]).then(a.bind(a,12888));case 2:return c=u.sent,u.abrupt("return",c);case 4:case"end":return u.stop()}},d)}))},to:"/settings/api-tokens/:id",exact:!0}];const bn=Zt;var Sn=function(){return window&&window.strapi&&window.strapi.isEE?a(49830).Z:a(19524).Z}();const Gt=[].concat((0,kt.Z)(Sn),(0,kt.Z)(bn));var mt=a(89420),Pn=Object.defineProperty,Jn=Object.defineProperties,Tn=Object.getOwnPropertyDescriptors,Ht=Object.getOwnPropertySymbols,Kt=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable,Xt=(m,d,c)=>d in m?Pn(m,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):m[d]=c,It=(m,d)=>{for(var c in d||(d={}))Kt.call(d,c)&&Xt(m,c,d[c]);if(Ht)for(var c of Ht(d))An.call(d,c)&&Xt(m,c,d[c]);return m},Yt=(m,d)=>Jn(m,Tn(d));const Qt=({menu:m})=>{const{formatMessage:d}=(0,V.useIntl)(),v=Cn(m).map(R=>Yt(It({},R),{title:R.intlLabel,links:R.links.map(M=>Yt(It({},M),{title:M.intlLabel,name:M.id}))})),u=d({id:"global.settings",defaultMessage:"Settings"});return e.createElement(mt.SubNav,{ariaLabel:u},e.createElement(mt.SubNavHeader,{label:u}),e.createElement(mt.SubNavSections,null,v.map(R=>e.createElement(mt.SubNavSection,{key:R.id,label:d(R.intlLabel)},R.links.map(M=>e.createElement(mt.SubNavLink,{as:s.NavLink,withBullet:M.hasNotification,to:M.to,key:M.id},d(M.intlLabel)))))))};Qt.propTypes={menu:f().array.isRequired};const On=Qt;function Et(){const{settingId:m}=(0,s.useParams)(),{settings:d}=(0,E.useStrapiApp)(),{formatMessage:c}=(0,V.useIntl)(),{isLoading:v,menu:u}=(0,Se.Te)(),R=(0,e.useMemo)(()=>(0,Ce.WW)(Gt.map(({to:C,Component:A,exact:te})=>(0,Ce.ot)(A,C,te))),[]),M=yn(d);if(v)return e.createElement(E.LoadingIndicatorPage,null);if(!m)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const T=c({id:"global.settings",defaultMessage:"Settings"});return e.createElement(ne.Layout,{sideNav:e.createElement(On,{menu:u})},e.createElement(Le.Helmet,{title:T}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:gn,exact:!0}),R,M))}const Rn=(0,e.memo)(Et)},12763:(fe,D,a)=>{a.d(D,{Z:()=>ne});var e=a(32735),E=a(5141);const ne=()=>e.createElement(E.Redirect,{to:"/404"})},20577:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},72238:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},97069:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},4594:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},34037:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},37926:(fe,D,a)=>{a.d(D,{Z:()=>gr});var e=a(32735),E=a(60216),s=a.n(E),ne=a(484),V=a(81700),Le=a(23973),Se=a.n(Le),Ce=a(86834),$e=a.n(Ce),X=a(5636),F=a(9808),P=a(19615),Z=a(98978),ge=a.n(Z),U=a(92577),de=a(67793),Ye=a.n(de),Qe=a(31476),Ge=a.n(Qe),Pe=a(35980),f=a(19192),we=a(33795),he=a.n(we),Je=a(9086),ue=a.n(Je),Y=a(55187),re=a(42258),_e=a.n(re),je=a(44526);const ot=P.default.div`
  position: relative;

  ${({hasConditions:o,disabled:t,theme:n})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${t?n.colors.neutral100:n.colors.primary600};
    }
  `}
`,He=({onClick:o,className:t,hasConditions:n,variant:r})=>{const{formatMessage:i}=(0,X.useIntl)();return e.createElement(ot,{hasConditions:n,className:t},e.createElement(je.Button,{variant:r,startIcon:e.createElement(_e(),null),onClick:o},i({id:"global.settings",defaultMessage:"Settings"})))};He.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},He.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const pe=(0,P.default)(He)``;var et=a(27635),at=a(90662),se=a(4122),Ue=a(71657),x=a(95602),j=a(49415),W=a(81346),ie=a.n(W),q=a(23940),G=a.n(q),Q=a(47169),_=a(21930),H=a(25716);const oe=`${120/16}rem`,Ne=`${200/16}rem`,Ve=`${53/16}rem`;function Ke(o,t){var n=typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!n){if(Array.isArray(o)||(n=rt(o))||t&&o&&typeof o.length=="number"){n&&(o=n);var r=0,i=function(){};return{s:i,n:function(){return r>=o.length?{done:!0}:{done:!1,value:o[r++]}},e:function(y){throw y},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,p=!1,g;return{s:function(){n=n.call(o)},n:function(){var y=n.next();return l=y.done,y},e:function(y){p=!0,g=y},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(p)throw g}}}}function rt(o,t){if(!!o){if(typeof o=="string")return ke(o,t);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ke(o,t)}}function ke(o,t){(t==null||t>o.length)&&(t=o.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=o[n];return r}var w=Object.defineProperty,k=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,xe=function(t,n,r){return n in t?w(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r},ze=function(t,n){for(var r in n||(n={}))z.call(n,r)&&xe(t,r,n[r]);if(k){var i=Ke(k(n)),l;try{for(i.s();!(l=i.n()).done;){var r=l.value;le.call(n,r)&&xe(t,r,n[r])}}catch(p){i.e(p)}finally{i.f()}}return t},qe=function(){return window&&window.strapi&&window.strapi.isEE?a(47594).Z:a(20577).Z}(),J=(0,P.default)(f.Flex).withConfig({displayName:"ActionRow__FlexWrapper",componentId:"sc-1bqpgdl-0"})(["height:",";"],Ve),ye=function(t){var n=t.arrayOfOptionsGroupedByCategory,r=t.isFormDisabled,i=t.isGrey,l=t.label,p=t.name,g=t.onChange,h=t.value,y=(0,X.useIntl)(),S=y.formatMessage,L=n.reduce(function(B,N){var O=(0,U.Z)(N,2),I=O[0],K=O[1],ce={label:G()(I),children:K.map(function(Oe){return{label:Oe.displayName,value:Oe.id}})};return[].concat((0,_.Z)(B),[ce])},[]),$=Object.values(h).map(function(B){return Object.entries(B).filter(function(N){var O=(0,U.Z)(N,2),I=O[1];return I}).map(function(N){var O=(0,U.Z)(N,1),I=O[0];return I})}).flat(),ee=function(N){var O=(0,U.Z)(n,1),I=(0,U.Z)(O[0],2),K=I[1],ce=K.reduce(function(Oe,Ee){return ze((0,Q.Z)({},Ee.id,N.includes(Ee.id)),Oe)},{});g(p,ce)};return e.createElement(J,{as:"li",background:i?"neutral100":"neutral0"},e.createElement(f.Flex,{paddingLeft:6,style:{width:180}},e.createElement(x.Typography,{variant:"sigma",textColor:"neutral600"},S({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(x.Typography,{variant:"sigma",title:l,textColor:"primary600",ellipsis:!0},S({id:"Settings.roles.form.permissions.".concat(l.toLowerCase()),defaultMessage:l})),e.createElement(x.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",S({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(F.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(H.MultiSelectNested,{id:p,customizeContent:function(N){return"".concat(N.length," currently selected")},onChange:ee,value:$,options:L,disabled:r||qe})))};ye.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const Ae=ye;var b=a(92891);const Vn=(o,t)=>o.reduce((n,r)=>(n[r.id]=(0,b.get)(t,r.id,!1),n),{}),qt=(o,t)=>o.reduce((n,r)=>{const[i,l]=r,p=Vn(l,t);return n[i]=p,n},{}),Tt=(o,t,n)=>o.reduce((r,i)=>{const l=(0,b.get)(t,[...i.pathToConditionsObject,"conditions"],{}),p=qt(n,l);return r[i.pathToConditionsObject.join("..")]=p,r},{});var _t=Object.defineProperty,yt=Object.getOwnPropertySymbols,en=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable,At=(o,t,n)=>t in o?_t(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Bt=(o,t)=>{for(var n in t||(t={}))en.call(t,n)&&At(o,n,t[n]);if(yt)for(var n of yt(t))st.call(t,n)&&At(o,n,t[n]);return o};const vt=({actions:o,headerBreadCrumbs:t,isFormDisabled:n,onClosed:r,onToggle:i})=>{const{formatMessage:l}=(0,X.useIntl)(),{availableConditions:p,modifiedData:g,onChangeConditions:h}=(0,Y.$_)(),y=(0,e.useMemo)(()=>Object.entries(ie()(p,"category")),[p]),S=o.filter(({isDisplayed:O,hasSomeActionsSelected:I,hasAllActionsSelected:K})=>O&&(I||K)),L=(0,e.useMemo)(()=>Tt(S,g,y),[S,g,y]),[$,ee]=(0,e.useState)(L),B=(O,I)=>{ee((0,j.default)(K=>{K[O]||(K[O]={}),K[O].default||(K[O].default={}),K[O].default=I}))},N=()=>{const O=Object.entries($).reduce((I,K)=>{const[ce,Oe]=K,Ee=Object.values(Oe).reduce((Re,Ie)=>Bt(Bt({},Re),Ie),{});return I[ce]=Ee,I},{});h(O),i()};return e.createElement(se.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:r},e.createElement(se.ModalHeader,null,e.createElement(Ue.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:t.join(", ")},t.map(O=>e.createElement(Ue.Crumb,{key:O},G()(l({id:O,defaultMessage:O})))))),e.createElement(F.Box,{padding:8},e.createElement(at.Stack,{spacing:6},e.createElement(x.Typography,{variant:"beta",as:"h2"},l({id:"Settings.permissions.conditions.define-conditions",defaultMessage:"Define conditions"})),e.createElement(F.Box,null,e.createElement(et.Divider,null)),e.createElement(F.Box,null,S.length===0&&e.createElement(x.Typography,null,l({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,S.map(({actionId:O,label:I,pathToConditionsObject:K},ce)=>{const Oe=K.join("..");return e.createElement(Ae,{key:O,arrayOfOptionsGroupedByCategory:y,label:I,isFormDisabled:n,isGrey:ce%2===0,name:Oe,onChange:B,value:he()($,Oe,{})})}))))),e.createElement(se.ModalFooter,{startActions:e.createElement(je.Button,{variant:"tertiary",onClick:i},l({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(je.Button,{onClick:N},l({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};vt.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const tn=vt,Ot=P.default.div`
  width: ${oe};
`,jt=(0,P.default)(f.Flex)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`;var Rt=Object.defineProperty,nn=Object.getOwnPropertySymbols,on=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,Nt=(o,t,n)=>t in o?Rt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,zn=(o,t)=>{for(var n in t||(t={}))on.call(t,n)&&Nt(o,n,t[n]);if(nn)for(var n of nn(t))an.call(t,n)&&Nt(o,n,t[n]);return o};const Dt=({children:o,isCollapsable:t,isActive:n,isFormDisabled:r,label:i,onChange:l,onClick:p,checkboxName:g,someChecked:h,value:y})=>{const{formatMessage:S}=(0,X.useIntl)();return e.createElement(f.Flex,{alignItems:"center",paddingLeft:6,style:{width:Ne,flexShrink:0}},e.createElement(F.Box,{paddingRight:2},e.createElement(Pe.BaseCheckbox,{name:g,"aria-label":S({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:i}),disabled:r,onValueChange:L=>l({target:{name:g,value:L}}),indeterminate:h,value:y})),e.createElement(jt,zn({title:i,alignItems:"center",isCollapsable:t},t&&{onClick:p,"aria-expanded":n,onKeyDown:({key:L})=>(L==="Enter"||L===" ")&&p(),tabIndex:0,role:"button"}),e.createElement(x.Typography,{fontWeight:n?"bold":"",textColor:n?"primary600":"neutral800",ellipsis:!0},G()(i)),o))};Dt.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},Dt.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const xt=(0,e.memo)(Dt),rn=o=>(0,b.isObject)(o)?(0,b.flattenDeep)(Object.values(o).map(t=>(0,b.isObject)(t)?rn(t):t)):[],ct=rn,Mt=o=>o?Object.keys(o).reduce((t,n)=>(n!=="conditions"&&(t[n]=o[n]),t),{}):null,it=o=>{const t=Mt(o),n=ct(t);if(!n.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const r=n.every(l=>l),i=n.some(l=>l)&&!r;return{hasAllActionsSelected:r,hasSomeActionsSelected:i}},Wt=(o,t,n)=>o.map(({actionId:r,isDisplayed:i,applyToProperties:l,label:p})=>{if(!i)return{actionId:r,hasSomeActionsSelected:!1,isDisplayed:i};const g=[...n.split(".."),r],h=(0,b.isEmpty)(l)?[...g,"properties","enabled"]:g,y=h.join(".."),S=(0,b.get)(t,[...g,"conditions"],null),L=ct(S).some(N=>N);if((0,b.isEmpty)(l)){const N=(0,b.get)(t,h,!1);return{actionId:r,checkboxName:y,hasAllActionsSelected:N,hasConditions:L,hasSomeActionsSelected:N,isDisplayed:i,isParentCheckbox:!1,label:p,pathToConditionsObject:g}}const $=(0,b.get)(t,h,null),{hasAllActionsSelected:ee,hasSomeActionsSelected:B}=it($);return{actionId:r,checkboxName:y,hasAllActionsSelected:ee,hasConditions:L,hasSomeActionsSelected:B,isDisplayed:i,isParentCheckbox:!0,label:p,pathToConditionsObject:g}});var sn=a(60672),ln=a.n(sn);const pt=(0,P.default)(ln())`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,Ct=o=>`
  ${x.Typography} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${pt} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var $t=function(){return window&&window.strapi&&window.strapi.isEE?a(65209).Z:a(72238).Z}(),Lt=function o(t,n){return`
  `.concat(dn,` {
    background-color: `).concat(t.colors.primary100,`;
    color: `).concat(t.colors.primary600,`;
    border-radius: `).concat(n?"2px 2px 0 0":"2px",`;
  }
  `).concat(Ut,` {
    display: flex;
  }
  `).concat(pe,` {
    display: block;
  }
  &:hover {
   `).concat(Ct(t),`
  }

  &:focus-within {
    `).concat(function(r){var i=r.theme,l=r.isActive;return o(i,l)},`
  }
  
`)},dn=P.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],Ve,function(o){var t=o.isGrey,n=o.theme;return t?n.colors.neutral100:n.colors.neutral0}),un=P.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],pe,function(o){var t=o.isActive,n=o.theme;return t&&Lt(n,t)},function(o){var t=o.theme,n=o.isActive;return Lt(t,n)}),pn=(0,P.default)(f.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],oe),Ut=(0,P.default)(F.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var t=o.theme;return t.colors.primary600}),Vt=P.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var t=o.theme;return t.colors.primary600}),Xn=(0,P.default)(F.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),mn=function(t){var n=t.availableActions,r=t.isActive,i=t.isGrey,l=t.isFormDisabled,p=t.label,g=t.onClickToggle,h=t.pathToData,y=(0,e.useState)(!1),S=(0,U.Z)(y,2),L=S[0],$=S[1],ee=(0,X.useIntl)(),B=ee.formatMessage,N=(0,Y.$_)(),O=N.modifiedData,I=N.onChangeParentCheckbox,K=N.onChangeSimpleCheckbox,ce=function(){$(function(Te){return!Te})},Oe=function(){$(!1)},Ee=he()(O,h.split(".."),{}),Re=(0,e.useMemo)(function(){return Object.keys(Ee).reduce(function(me,Te){return me[Te]=ue()(Ee[Te],"conditions"),me},{})},[Ee]),Ie=it(Re),Me=Ie.hasAllActionsSelected,ft=Ie.hasSomeActionsSelected,be=(0,e.useMemo)(function(){return Wt(n,O,h)},[n,O,h]),Fe=be.some(function(me){var Te=me.hasConditions;return Te});return e.createElement(un,{isActive:r},e.createElement(dn,{isGrey:i},e.createElement(xt,{isCollapsable:!0,isFormDisabled:l,label:p,checkboxName:h,onChange:I,onClick:g,someChecked:ft,value:Me,isActive:r},e.createElement(Ut,{paddingLeft:2},r?e.createElement(Ge(),null):e.createElement(Ye(),null))),e.createElement(f.Flex,{style:{flex:1}},be.map(function(me){var Te=me.actionId,De=me.hasConditions,Be=me.hasAllActionsSelected,We=me.hasSomeActionsSelected,ut=me.isDisplayed,Ze=me.isParentCheckbox,lt=me.checkboxName,St=me.label;return ut?Ze?e.createElement(pn,{key:Te,justifyContent:"center",alignItems:"center"},De&&e.createElement(Vt,null),e.createElement(Pe.BaseCheckbox,{disabled:l||$t,name:lt,"aria-label":B({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(St," ").concat(p)}),onValueChange:function(ht){I({target:{name:lt,value:ht}})},indeterminate:We,value:Be})):e.createElement(pn,{key:Te,justifyContent:"center",alignItems:"center"},De&&e.createElement(Vt,null),e.createElement(Pe.BaseCheckbox,{disabled:l||$t,indeterminate:De,name:lt,onValueChange:function(ht){K({target:{name:lt,value:ht}})},value:Be})):e.createElement(Ot,{key:Te})})),L&&e.createElement(tn,{headerBreadCrumbs:[p,"app.components.LeftMenuLinkContainer.settings"],actions:be,isFormDisabled:l,onClosed:Oe,onToggle:ce})),e.createElement(Xn,null,e.createElement(pe,{onClick:ce,hasConditions:Fe})))};mn.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const gn=mn,fn=(o,t)=>o.map(n=>{const r=Array.isArray(n.applyToProperties)&&n.applyToProperties.indexOf(t)!==-1&&n.isDisplayed;return{label:n.label,actionId:n.actionId,isActionRelatedToCurrentProperty:r}}),hn=(0,P.default)(f.Flex)`
  width: ${oe};
  flex-shrink: 0;
`,yn=(0,P.default)(f.Flex)`
  width: ${Ne};
  height: ${Ve};
  flex-shrink: 0;
`,vn=({headers:o,label:t})=>{const{formatMessage:n}=(0,X.useIntl)(),r=n({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:t});return e.createElement(f.Flex,null,e.createElement(yn,{alignItems:"center",paddingLeft:6},e.createElement(x.Typography,{variant:"sigma",textColor:"neutral500"},r)),o.map(i=>i.isActionRelatedToCurrentProperty?e.createElement(hn,{justifyContent:"center",key:i.label},e.createElement(x.Typography,{variant:"sigma",textColor:"neutral500"},n({id:`Settings.roles.form.permissions.${i.label.toLowerCase()}`,defaultMessage:i.label}))):e.createElement(hn,{key:i.label})))};vn.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const Cn=vn,kt=P.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,ve=()=>e.createElement(kt,null,"*");var tt=Object.defineProperty,zt=Object.defineProperties,En=Object.getOwnPropertyDescriptors,Zt=Object.getOwnPropertySymbols,bn=Object.prototype.hasOwnProperty,Sn=Object.prototype.propertyIsEnumerable,Gt=(o,t,n)=>t in o?tt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,mt=(o,t)=>{for(var n in t||(t={}))bn.call(t,n)&&Gt(o,n,t[n]);if(Zt)for(var n of Zt(t))Sn.call(t,n)&&Gt(o,n,t[n]);return o},Pn=(o,t)=>zt(o,En(t));const Tn=(o,t)=>o.map(n=>{const r=Array.isArray(n.subjects)&&n.subjects.indexOf(t)!==-1;return Pn(mt({},n),{isDisplayed:r})});var Ht=Object.defineProperty,Kt=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,It=(o,t,n)=>t in o?Ht(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Yt=(o,t)=>{for(var n in t||(t={}))An.call(t,n)&&It(o,n,t[n]);if(Kt)for(var n of Kt(t))Xt.call(t,n)&&It(o,n,t[n]);return o};const Qt=(0,P.default)(F.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,On=P.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:t})=>o.colors[t]};
  }
`,Et=o=>e.createElement(Qt,null,e.createElement(On,Yt({width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Et.defaultProps={fill:"primary200"},Et.propTypes={fill:s().string};const Rn=(0,e.memo)(Et);function m(o,t){var n=typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!n){if(Array.isArray(o)||(n=d(o))||t&&o&&typeof o.length=="number"){n&&(o=n);var r=0,i=function(){};return{s:i,n:function(){return r>=o.length?{done:!0}:{done:!1,value:o[r++]}},e:function(y){throw y},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,p=!1,g;return{s:function(){n=n.call(o)},n:function(){var y=n.next();return l=y.done,y},e:function(y){p=!0,g=y},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(p)throw g}}}}function d(o,t){if(!!o){if(typeof o=="string")return c(o,t);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(o,t)}}function c(o,t){(t==null||t>o.length)&&(t=o.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=o[n];return r}var v=Object.defineProperty,u=Object.defineProperties,R=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,A=function(t,n,r){return n in t?v(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r},te=function(t,n){for(var r in n||(n={}))T.call(n,r)&&A(t,r,n[r]);if(M){var i=m(M(n)),l;try{for(i.s();!(l=i.n()).done;){var r=l.value;C.call(n,r)&&A(t,r,n[r])}}catch(p){i.e(p)}finally{i.f()}}return t},ae=function(t,n){return u(t,R(n))},Xe=function(){return window&&window.strapi&&window.strapi.isEE?a(37633).Z:a(4594).Z}(),nt=(0,P.default)(f.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],oe),dt=(0,P.default)(f.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],Ve),bt=(0,P.default)(F.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),gt=(0,P.default)(F.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var t=o.isVisible,n=o.theme;return t?"4px solid ".concat(n.colors.primary200):"4px solid transparent"}),zo=(0,P.default)(f.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var t=o.theme;return t.spaces[4]},function(o){var t=o.level;return 145-t*36},function(o){var t=o.isCollapsable,n=o.theme;return t&&`
      `.concat(pt,` {
        display: block;
        color: `).concat(n.colors.neutral100,`;
      }
      &:hover {
        `).concat(Ct(n),`
      }
  `)},function(o){var t=o.isActive,n=o.theme;return t&&Ct(n)}),Zo=P.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var t=o.theme;return t.spaces[2]},function(o){var t=o.theme;return t.spaces[2]},4/16,function(o){var t=o.theme;return t.colors.primary200}),qn=function o(t){var n=t.childrenForm,r=t.isFormDisabled,i=t.recursiveLevel,l=t.pathToDataFromActionRow,p=t.propertyActions,g=t.parentName,h=t.propertyName,y=(0,X.useIntl)(),S=y.formatMessage,L=(0,Y.$_)(),$=L.modifiedData,ee=L.onChangeParentCheckbox,B=L.onChangeSimpleCheckbox,N=(0,e.useState)(null),O=(0,U.Z)(N,2),I=O[0],K=O[1],ce=function(Re){K(function(Ie){return Ie===Re?null:Re})},Oe=(0,e.useMemo)(function(){return I?n.find(function(Ee){var Re=Ee.value;return Re===I}):null},[I,n]);return e.createElement(bt,null,e.createElement(Zo,null),n.map(function(Ee,Re){var Ie=Ee.label,Me=Ee.value,ft=Ee.required,be=Ee.children,Fe=Re+1<n.length,me=Array.isArray(be),Te=I===Me;return e.createElement(gt,{key:Me,isVisible:Fe},e.createElement(dt,null,e.createElement(Rn,{color:"primary200"}),e.createElement(f.Flex,{style:{flex:1}},e.createElement(zo,{level:i,isActive:Te,isCollapsable:me},e.createElement(jt,ae(te({alignItems:"center",isCollapsable:me},me&&{onClick:function(){return ce(Me)},"aria-expanded":Te,onKeyDown:function(Be){var We=Be.key;return(We==="Enter"||We===" ")&&ce(Me)},tabIndex:0,role:"button"}),{title:Ie}),e.createElement(x.Typography,{ellipsis:!0},G()(Ie)),ft&&e.createElement(ve,null),e.createElement(pt,{$isActive:Te}))),e.createElement(f.Flex,{style:{flex:1}},p.map(function(De){var Be=De.actionId,We=De.label,ut=De.isActionRelatedToCurrentProperty;if(!ut)return e.createElement(Ot,{key:Be});var Ze=[].concat((0,_.Z)(l.split("..")),[Be,"properties",h],(0,_.Z)(g.split("..")),[Me]),lt=he()($,Ze,!1);if(!be)return e.createElement(nt,{key:We,justifyContent:"center",alignItems:"center"},e.createElement(Pe.BaseCheckbox,{disabled:r||Xe,name:Ze.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(g," ").concat(Ie," ").concat(We)}),onValueChange:function(Ft){B({target:{name:Ze.join(".."),value:Ft}})},value:lt}));var St=it(lt),Pt=St.hasAllActionsSelected,ht=St.hasSomeActionsSelected;return e.createElement(nt,{key:We,justifyContent:"center",alignItems:"center"},e.createElement(Pe.BaseCheckbox,{key:We,disabled:r||Xe,name:Ze.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(g," ").concat(Ie," ").concat(We)}),onValueChange:function(Ft){ee({target:{name:Ze.join(".."),value:Ft}})},value:Pt,indeterminate:ht}))})))),Oe&&Te&&e.createElement(F.Box,{paddingBottom:2},e.createElement(o,{isFormDisabled:r,parentName:"".concat(g,"..").concat(Me),pathToDataFromActionRow:l,propertyActions:p,propertyName:h,recursiveLevel:i+1,childrenForm:Oe.children})))}))};qn.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const Go=(0,e.memo)(qn),Ho=o=>o.reduce((n,r)=>(r.isActionRelatedToCurrentProperty&&n.push(r.actionId),n),[]),Ko=(o,t,n,r,i)=>{const p=Ho(o).reduce((g,h)=>{const y=[...n.split(".."),h,"properties",r,i],S=(0,b.get)(t,y,!1);return g[h]=S,g},{});return it(p)};var _n=function(){return window&&window.strapi&&window.strapi.isEE?a(22609).Z:a(97069).Z}(),eo=(0,P.default)(f.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],oe),Xo=(0,P.default)(f.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],Ve,function(o){var t=o.isCollapsable,n=o.theme;return t&&`
      `.concat(pt,` {
        display: block;
        color: `).concat(n.colors.neutral100,`;
      }
      &:hover {
        `).concat(Ct(n),`
      }
  `)},function(o){var t=o.isActive,n=o.theme;return t&&Ct(n)}),Dn=function(t){var n=t.childrenForm,r=t.label,i=t.isFormDisabled,l=t.name,p=t.required,g=t.pathToData,h=t.propertyActions,y=t.propertyName,S=t.isOdd,L=(0,X.useIntl)(),$=L.formatMessage,ee=(0,e.useState)(null),B=(0,U.Z)(ee,2),N=B[0],O=B[1],I=(0,Y.$_)(),K=I.modifiedData,ce=I.onChangeCollectionTypeLeftActionRowCheckbox,Oe=I.onChangeParentCheckbox,Ee=I.onChangeSimpleCheckbox,Re=N===l,Ie=(0,e.useMemo)(function(){return Array.isArray(n)?n:[]},[n]),Me=Ie.length>0,ft=(0,e.useCallback)(function(){Me&&O(function(De){return De===l?null:l})},[Me,l]),be=function(Be){var We=Be.target.value;ce(g,y,l,We)},Fe=(0,e.useMemo)(function(){return Ko(h,K,g,y,l)},[h,K,g,y,l]),me=Fe.hasAllActionsSelected,Te=Fe.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(Xo,{alignItems:"center",isCollapsable:Me,isActive:Re,background:S?"neutral100":"neutral0"},e.createElement(f.Flex,null,e.createElement(xt,{onChange:be,onClick:ft,isCollapsable:Me,isFormDisabled:i,label:r,someChecked:Te,value:me,isActive:Re},p&&e.createElement(ve,null),e.createElement(pt,{$isActive:Re})),e.createElement(f.Flex,null,h.map(function(De){var Be=De.label,We=De.isActionRelatedToCurrentProperty,ut=De.actionId;if(!We)return e.createElement(Ot,{key:Be});var Ze=[].concat((0,_.Z)(g.split("..")),[ut,"properties",y,l]);if(!Me){var lt=he()(K,Ze,!1);return e.createElement(eo,{key:ut,justifyContent:"center",alignItems:"center"},e.createElement(Pe.BaseCheckbox,{disabled:i||_n,name:Ze.join(".."),"aria-label":$({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(l," ").concat(Be)}),onValueChange:function(Un){Ee({target:{name:Ze.join(".."),value:Un}})},value:lt}))}var St=he()(K,Ze,{}),Pt=it(St),ht=Pt.hasAllActionsSelected,$n=Pt.hasSomeActionsSelected;return e.createElement(eo,{key:Be,justifyContent:"center",alignItems:"center"},e.createElement(Pe.BaseCheckbox,{disabled:i||_n,name:Ze.join(".."),onValueChange:function(Un){Oe({target:{name:Ze.join(".."),value:Un}})},"aria-label":$({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(l," ").concat(Be)}),value:ht,indeterminate:$n}))})))),Re&&e.createElement(Go,{childrenForm:Ie,isFormDisabled:i,parentName:l,pathToDataFromActionRow:g,propertyName:y,propertyActions:h,recursiveLevel:0}))};Dn.defaultProps={childrenForm:[],required:!1},Dn.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const Yo=(0,e.memo)(Dn),Qo=P.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,to=({availableActions:o,childrenForm:t,isFormDisabled:n,label:r,pathToData:i,propertyName:l})=>{const p=(0,e.useMemo)(()=>fn(o,l),[o,l]);return e.createElement(Qo,null,e.createElement(Cn,{label:r,headers:p}),e.createElement(F.Box,null,t.map(({children:g,label:h,value:y,required:S},L)=>e.createElement(Yo,{childrenForm:g,key:y,label:h,isFormDisabled:n,name:y,required:S,propertyActions:p,pathToData:i,propertyName:l,isOdd:L%2===0}))))};to.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const Jo=to,qo=P.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:t})=>t&&`border: 1px solid ${o.colors.primary600};`}
`,no=({allActions:o,contentTypeName:t,label:n,index:r,isActive:i,isFormDisabled:l,onClickToggleCollapse:p,pathToData:g,properties:h})=>{const y=(0,e.useCallback)(()=>{p(t)},[t,p]),S=(0,e.useMemo)(()=>Tn(o,t),[o,t]);return e.createElement(qo,{isActive:i},e.createElement(gn,{availableActions:S,isActive:i,isGrey:r%2===0,isFormDisabled:l,label:n,onClickToggle:y,pathToData:g}),i&&h.map(({label:L,value:$,children:ee})=>e.createElement(Jo,{availableActions:S,childrenForm:ee,isFormDisabled:l,label:L,pathToData:g,propertyName:$,key:$})))};no.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const _o=no,xn=({actions:o,isFormDisabled:t,pathToData:n,subjects:r})=>{const[i,l]=(0,e.useState)(null),p=g=>{l(i===g?null:g)};return r.map(({uid:g,label:h,properties:y},S)=>e.createElement(_o,{allActions:o,key:g,contentTypeName:g,label:h,isActive:i===g,isFormDisabled:t,index:S,onClickToggleCollapse:p,pathToData:`${n}..${g}`,properties:y}))};xn.defaultProps={actions:[],subjects:[]},xn.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const ea=(0,e.memo)(xn),ta=o=>o.filter(({subjects:t})=>t&&t.length);var na=Object.defineProperty,oo=Object.getOwnPropertySymbols,oa=Object.prototype.hasOwnProperty,aa=Object.prototype.propertyIsEnumerable,ao=(o,t,n)=>t in o?na(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,ro=(o,t)=>{for(var n in t||(t={}))oa.call(t,n)&&ao(o,n,t[n]);if(oo)for(var n of oo(t))aa.call(t,n)&&ao(o,n,t[n]);return o};const ra=o=>o.map(({actionId:t})=>t),sa=(o,t)=>o.reduce((n,r)=>(Object.keys(t).forEach(i=>{const l=(0,b.get)(t,[i,r],{}),p={[i]:Mt(l)};n[r]?n[r]=ro(ro({},n[r]),p):n[r]=p}),n),{}),ia=(o,t)=>{const n=ra(o),r=sa(n,t);return Object.keys(r).reduce((l,p)=>(l[p]=it(r[p]),l),{})};var la=function(){return window&&window.strapi&&window.strapi.isEE?a(56388).Z:a(34037).Z}(),ca=(0,P.default)(at.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],oe),Mn=function(t){var n=t.actions,r=t.isFormDisabled,i=t.kind,l=(0,X.useIntl)(),p=l.formatMessage,g=(0,Y.$_)(),h=g.modifiedData,y=g.onChangeCollectionTypeGlobalActionCheckbox,S=(0,e.useMemo)(function(){return ta(n)},[n]),L=(0,e.useMemo)(function(){return ia(S,h[i])},[h,S,i]);return e.createElement(F.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Ne}},e.createElement(at.Stack,{horizontal:!0,spacing:0},S.map(function($){var ee=$.label,B=$.actionId;return e.createElement(ca,{key:B,spacing:3},e.createElement(x.Typography,{variant:"sigma",textColor:"neutral500"},p({id:"Settings.roles.form.permissions.".concat(ee.toLowerCase()),defaultMessage:ee})),e.createElement(Pe.BaseCheckbox,{disabled:r||la,onValueChange:function(O){y(i,B,O)},name:B,"aria-label":p({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:p({id:"Settings.roles.form.permissions.".concat(ee.toLowerCase()),defaultMessage:ee})}),value:he()(L,[B,"hasAllActionsSelected"],!1),indeterminate:he()(L,[B,"hasSomeActionsSelected"],!1)}))})))};Mn.defaultProps={actions:[]},Mn.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const da=(0,e.memo)(Mn),ua=(0,P.default)(F.Box)`
  overflow-x: auto;
`,so=({isFormDisabled:o,kind:t,layout:{actions:n,subjects:r}})=>{const i=ge()([...r],"label");return e.createElement(ua,{background:"neutral0"},e.createElement(da,{actions:n,kind:t,isFormDisabled:o}),e.createElement(ea,{actions:n,isFormDisabled:o,pathToData:t,subjects:i}))};so.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const io=(0,e.memo)(so);var pa=a(41445);const lo=({children:o,value:t})=>e.createElement(pa.$l.Provider,{value:t},o);lo.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const ma=lo;var Ln=a(12001),co=a(78330),uo=a(52111),ga=Object.defineProperty,fa=Object.defineProperties,ha=Object.getOwnPropertyDescriptors,po=Object.getOwnPropertySymbols,ya=Object.prototype.hasOwnProperty,va=Object.prototype.propertyIsEnumerable,mo=(o,t,n)=>t in o?ga(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Ca=(o,t)=>{for(var n in t||(t={}))ya.call(t,n)&&mo(o,n,t[n]);if(po)for(var n of po(t))va.call(t,n)&&mo(o,n,t[n]);return o},Ea=(o,t)=>fa(o,ha(t));const ba=(o,t,n)=>o.map(r=>{const i=[...n,r.action,"properties","enabled"],l=(0,b.get)(t,i,!1),p=(0,b.get)(t,[...n,r.action,"conditions"],{}),g=ct(p).some(h=>h);return Ea(Ca({},r),{isDisplayed:l,checkboxName:i.join(".."),hasSomeActionsSelected:l,value:l,hasConditions:g,label:r.displayName,actionId:r.action,pathToConditionsObject:[...n,r.action]})}),Sa=o=>{const t=Object.entries(o).reduce((r,i)=>{const[l,{conditions:p}]=i;return r[l]=p,r},{});return ct(t).some(r=>r)};var In=function(){return window&&window.strapi&&window.strapi.isEE?a(10667).Z:a(92620).Z}(),Pa=P.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var t=o.theme;return t.colors.neutral150}),Ta=P.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var t=o.hasConditions,n=o.disabled,r=o.theme;return t&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(n?r.colors.neutral100:r.colors.primary600,`;
    }
  `)}),go=function(t){var n=t.categoryName,r=t.isFormDisabled,i=t.subCategoryName,l=t.actions,p=t.pathToData,g=(0,e.useState)(!1),h=(0,U.Z)(g,2),y=h[0],S=h[1],L=(0,Y.$_)(),$=L.modifiedData,ee=L.onChangeParentCheckbox,B=L.onChangeSimpleCheckbox,N=(0,X.useIntl)(),O=N.formatMessage,I=he()($,p,{}),K=(0,e.useMemo)(function(){return Object.keys(I).reduce(function(be,Fe){return be[Fe]=Mt(I[Fe]),be},{})},[I]),ce=it(K),Oe=ce.hasAllActionsSelected,Ee=ce.hasSomeActionsSelected,Re=function(){S(function(Fe){return!Fe})},Ie=function(){S(!1)},Me=ba(l,$,p),ft=Sa(he()($,(0,_.Z)(p),{}));return e.createElement(e.Fragment,null,e.createElement(F.Box,null,e.createElement(f.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(F.Box,{paddingRight:4},e.createElement(x.Typography,{variant:"sigma",textColor:"neutral600"},i)),e.createElement(Pa,null),e.createElement(F.Box,{paddingLeft:4},e.createElement(uo.Checkbox,{name:p.join(".."),disabled:r||In,onValueChange:function(Fe){ee({target:{name:p.join(".."),value:Fe}})},indeterminate:Ee,value:Oe},O({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(f.Flex,{paddingTop:6,paddingBottom:6},e.createElement(co.Grid,{gap:2,style:{flex:1}},Me.map(function(be){var Fe=be.checkboxName,me=be.value,Te=be.action,De=be.displayName,Be=be.hasConditions;return e.createElement(co.GridItem,{col:3,key:Te},e.createElement(Ta,{disabled:r||In,hasConditions:Be},e.createElement(uo.Checkbox,{name:Fe,disabled:r||In,onValueChange:function(ut){B({target:{name:Fe,value:ut}})},value:me},De)))})),e.createElement(pe,{hasConditions:ft,onClick:Re}))),y&&e.createElement(tn,{headerBreadCrumbs:[n,i],actions:Me,isFormDisabled:r,onClosed:Ie,onToggle:Re}))};go.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const Aa=go,Fn=({childrenForm:o,kind:t,name:n,isOpen:r,isFormDisabled:i,isWhite:l,onOpenCategory:p,pathToData:g})=>{const{formatMessage:h}=(0,X.useIntl)(),y=()=>{p(n)},S=(0,e.useMemo)(()=>n.split("::").pop(),[n]);return e.createElement(Ln.Accordion,{expanded:r,onToggle:y,id:`accordion-${n}`,variant:l?"primary":"secondary"},e.createElement(Ln.AccordionToggle,{title:G()(S),description:`${h({id:"Settings.permissions.category"},{category:S})} ${t==="plugins"?"plugin":t}`}),e.createElement(Ln.AccordionContent,null,e.createElement(F.Box,{padding:6},o.map(({actions:L,subCategoryName:$,subCategoryId:ee})=>e.createElement(Aa,{key:$,actions:L,categoryName:S,isFormDisabled:i,subCategoryName:$,pathToData:[...g,ee]})))))};Fn.defaultProps={},Fn.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const Oa=Fn,fo=({isFormDisabled:o,kind:t,layout:n})=>{const[r,i]=(0,e.useState)(null),l=p=>{i(p===r?null:p)};return e.createElement(F.Box,{padding:6,background:"neutral0"},n.map(({category:p,categoryId:g,childrenForm:h},y)=>e.createElement(Oa,{key:p,childrenForm:h,kind:t,isFormDisabled:o,isOpen:r===p,isWhite:y%2===1,name:p,onOpenCategory:l,pathToData:[t,g]})))};fo.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const ho=fo,yo=(o,t,n)=>o.find(r=>r.action===t&&r.subject===n);var Ra=Object.defineProperty,Da=Object.defineProperties,xa=Object.getOwnPropertyDescriptors,vo=Object.getOwnPropertySymbols,Ma=Object.prototype.hasOwnProperty,La=Object.prototype.propertyIsEnumerable,Co=(o,t,n)=>t in o?Ra(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Eo=(o,t)=>{for(var n in t||(t={}))Ma.call(t,n)&&Co(o,n,t[n]);if(vo)for(var n of vo(t))La.call(t,n)&&Co(o,n,t[n]);return o},bo=(o,t)=>Da(o,xa(t));const So=(o,t=[])=>o.reduce((n,r)=>(n[r.id]=t.indexOf(r.id)!==-1,n),{}),Po=({children:o},t,n="")=>o.reduce((r,i)=>{if(i.children)return bo(Eo({},r),{[i.value]:Po(i,t,`${n}${i.value}.`)});const l=t.indexOf(`${n}${i.value}`)!==-1;return r[i.value]=l,r},{}),Ia=(o,t,n)=>o.reduce((r,i)=>{const l=t.properties.find(({value:p})=>p===i);if(l){const p=(0,b.get)(n,["properties",l.value],[]),g=Po(l,p);r.properties[i]=g}return r},{properties:{}}),Fa=(o,t)=>t.reduce((n,r)=>{const i=o.find(({uid:l})=>l===r)||null;return i&&(n[r]=i),n},{}),To=({subjects:o},t,n,r=[])=>t.reduce((i,l)=>{const p=l.subjects,g=Fa(o,p);if((0,b.isEmpty)(g))return i;const h=Object.keys(g).reduce((y,S)=>{const{actionId:L,applyToProperties:$}=l,N=g[S].properties.map(({value:ce})=>ce).every(ce=>($||[]).indexOf(ce)===-1),O=yo(r,L,S),I=So(n,(0,b.get)(O,"conditions",[]));if((0,b.isEmpty)($)||N)return(0,b.set)(y,[S,L],{properties:{enabled:O!==void 0},conditions:I}),y;const K=Ia($,g[S],O);return(0,b.set)(y,[S,L],bo(Eo({},K),{conditions:I})),y},{});return(0,b.merge)(i,h)},{}),Ba=(o,t,n)=>o.reduce((r,i)=>{const l=yo(n,i.action,null);return r[i.action]={properties:{enabled:l!==void 0},conditions:So(t,(0,b.get)(l,"conditions",[]))},r},{}),wa=(o,t,n)=>o.reduce((r,i)=>(r[i.subCategoryId]=Ba(i.actions,t,n),r),{}),Ao=(o,t,n=[])=>o.reduce((r,{categoryId:i,childrenForm:l})=>{const p=wa(l,t,n);return r[i]=p,r},{}),Oo=o=>o.split(" ").join("-"),Ro=(o,t)=>(0,b.chain)(o).groupBy(t).map((n,r)=>({category:r,categoryId:Oo(r),childrenForm:(0,b.chain)(n).groupBy("subCategory").map((i,l)=>({subCategoryName:l,subCategoryId:Oo(l),actions:i})).value()})).value(),ja=(o,t)=>{const{conditions:n,sections:{collectionTypes:r,singleTypes:i,plugins:l,settings:p}}=o,g={collectionTypes:r,singleTypes:i,plugins:Ro(l,"plugin"),settings:Ro(p,"category")},h={collectionTypes:To(r,r.actions||[],n,t),singleTypes:To(i,i.actions||[],n,t),plugins:Ao(g.plugins,n,t),settings:Ao(g.settings,n,t)};return{initialData:h,modifiedData:h,layouts:g}};var Na=Object.defineProperty,Wa=Object.defineProperties,$a=Object.getOwnPropertyDescriptors,Do=Object.getOwnPropertySymbols,Ua=Object.prototype.hasOwnProperty,Va=Object.prototype.propertyIsEnumerable,xo=(o,t,n)=>t in o?Na(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Bn=(o,t)=>{for(var n in t||(t={}))Ua.call(t,n)&&xo(o,n,t[n]);if(Do)for(var n of Do(t))Va.call(t,n)&&xo(o,n,t[n]);return o},wn=(o,t)=>Wa(o,$a(t));const Mo=o=>Object.keys(o).reduce((t,n)=>{const r=o[n];if((0,b.isObject)(r)&&!(0,b.has)(r,"conditions"))return wn(Bn({},t),{[n]:Mo(r)});if((0,b.isObject)(r)&&(0,b.has)(r,"conditions")&&!ct((0,b.omit)(r,"conditions")).some(l=>l)){const l=Object.keys(r.conditions).reduce((p,g)=>(p[g]=!1,p),{});return wn(Bn({},t),{[n]:wn(Bn({},r),{conditions:l})})}return t[n]=r,t},{}),jn=Mo;var ka=Object.defineProperty,za=Object.defineProperties,Za=Object.getOwnPropertyDescriptors,Lo=Object.getOwnPropertySymbols,Ga=Object.prototype.hasOwnProperty,Ha=Object.prototype.propertyIsEnumerable,Io=(o,t,n)=>t in o?ka(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Ka=(o,t)=>{for(var n in t||(t={}))Ga.call(t,n)&&Io(o,n,t[n]);if(Lo)for(var n of Lo(t))Ha.call(t,n)&&Io(o,n,t[n]);return o},Xa=(o,t)=>za(o,Za(t));const Fo=(o,t)=>Object.keys(o).reduce((n,r)=>{const i=o[r];return r==="conditions"?(n[r]=i,n):(0,b.isObject)(i)?Xa(Ka({},n),{[r]:Fo(i,t)}):(n[r]=t,n)},{}),Jt=Fo;var Ya=Object.defineProperty,Qa=Object.defineProperties,Ja=Object.getOwnPropertyDescriptors,Bo=Object.getOwnPropertySymbols,qa=Object.prototype.hasOwnProperty,_a=Object.prototype.propertyIsEnumerable,wo=(o,t,n)=>t in o?Ya(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,er=(o,t)=>{for(var n in t||(t={}))qa.call(t,n)&&wo(o,n,t[n]);if(Bo)for(var n of Bo(t))_a.call(t,n)&&wo(o,n,t[n]);return o},tr=(o,t)=>Qa(o,Ja(t));const nr={initialData:{},modifiedData:{},layouts:{}},or=(o,t)=>(0,j.default)(o,n=>{switch(t.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:r,actionId:i,value:l}=t,p=["modifiedData",r];Object.keys((0,b.get)(o,p)).forEach(g=>{const h=(0,b.get)(o,[...p,g,i],void 0);if(h){let y=Jt(h,l);if(!l&&y.conditions){const S=Jt(y.conditions,!1);y=tr(er({},y),{conditions:S})}(0,b.set)(n,[...p,g,i],y)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:r,propertyName:i,rowName:l,value:p}=t;let g=(0,b.cloneDeep)(o.modifiedData);const h=r.split(".."),y=(0,b.get)(g,h,{});Object.keys(y).forEach(S=>{if((0,b.has)(y[S],`properties.${i}`)){const L=(0,b.get)(y,[S,"properties",i,l]),$=[...h,S,"properties",i,l];if(!(0,b.isObject)(L))(0,b.set)(g,$,p);else{const ee=Jt(L,p);(0,b.set)(g,$,ee)}}}),p||(g=jn(g)),(0,b.set)(n,"modifiedData",g);break}case"ON_CHANGE_CONDITIONS":{Object.entries(t.conditions).forEach(r=>{const[i,l]=r;(0,b.set)(n,["modifiedData",...i.split(".."),"conditions"],l)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let r=(0,b.cloneDeep)(o.modifiedData);(0,b.set)(r,[...t.keys.split("..")],t.value),t.value||(r=jn(r)),(0,b.set)(n,"modifiedData",r);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:r,value:i}=t,l=[...r.split("..")];let p=(0,b.cloneDeep)(o.modifiedData);const g=(0,b.get)(p,l,{}),h=Jt(g,i);(0,b.set)(p,l,h),i||(p=jn(p)),(0,b.set)(n,["modifiedData"],p);break}case"RESET_FORM":{n.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{n.initialData=o.modifiedData;break}default:return n}}),Nn=o=>Object.entries(o).filter(([,t])=>t).map(([t])=>t),ar=o=>{const[t,{conditions:n}]=o;return{action:t,subject:null,conditions:Nn(n),properties:{}}},rr=o=>Object.values(o).reduce((t,n)=>{const r=Object.entries(n).reduce((i,l)=>{const[,{properties:{enabled:p}}]=l;if(!p)return i;const g=ar(l);return i.push(g),i},[]);return[...t,...r]},[]),jo=o=>Object.values(o).reduce((t,n)=>{const r=rr(n);return[...t,...r]},[]),No=(o,t="")=>Object.entries(o).reduce((n,r)=>{const[i,l]=r;return(0,b.isObject)(l)?[...n,...No(l,`${t}${i}.`)]:(l&&!(0,b.isObject)(l)&&n.push(`${t}${i}`),n)},[]),sr=(o,t,{conditions:n,properties:r})=>Object.entries(r).reduce((i,l)=>{const[p,g]=l;return i.properties[p]=No(g),i},{action:o,subject:t,conditions:Nn(n),properties:{}}),ir=(o,t,{conditions:n})=>({action:o,subject:t,properties:{},conditions:Nn(n)}),lr=(o,t)=>Object.entries(t).reduce((r,i)=>{const[l,p]=i;if(!ct(p).some(y=>y))return r;if(!(0,b.has)(p,"properties.enabled")){const y=sr(l,o,p);return[...r,y]}if(!p.properties.enabled)return r;const h=ir(l,o,p);return r.push(h),r},[]),Wo=o=>Object.entries(o).reduce((n,r)=>{const[i,l]=r,p=lr(i,l);return[...n,...p]},[]),cr=o=>{const t=jo(o.plugins),n=jo(o.settings),r=Wo(o.collectionTypes),i=Wo(o.singleTypes);return[...t,...n,...r,...i]},dr=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}];var ur=Object.defineProperty,$o=Object.getOwnPropertySymbols,pr=Object.prototype.hasOwnProperty,mr=Object.prototype.propertyIsEnumerable,Uo=(o,t,n)=>t in o?ur(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Vo=(o,t)=>{for(var n in t||(t={}))pr.call(t,n)&&Uo(o,n,t[n]);if($o)for(var n of $o(t))mr.call(t,n)&&Uo(o,n,t[n]);return o};const Wn=(0,e.forwardRef)(({layout:o,isFormDisabled:t,permissions:n},r)=>{const[{initialData:i,layouts:l,modifiedData:p},g]=(0,e.useReducer)(or,nr,()=>ja(o,n)),{formatMessage:h}=(0,X.useIntl)();(0,e.useImperativeHandle)(r,()=>({getPermissions(){const B=(0,ne.difference)(i.collectionTypes,p.collectionTypes),N=(0,ne.difference)(i.singleTypes,p.singleTypes),O=Vo(Vo({},B),N);let I;return $e()(O)?I=!1:I=Object.values(O).some(K=>Object.values(K).some(ce=>Se()(ce,"conditions"))),{permissionsToSend:cr(p),didUpdateConditions:I}},resetForm(){g({type:"RESET_FORM"})},setFormAfterSubmit(){g({type:"SET_FORM_AFTER_SUBMIT"})}}));const y=(B,N,O,I)=>{g({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:B,propertyName:N,rowName:O,value:I})},S=(B,N,O)=>{g({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:B,actionId:N,value:O})},L=B=>{g({type:"ON_CHANGE_CONDITIONS",conditions:B})},$=(0,e.useCallback)(({target:{name:B,value:N}})=>{g({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:B,value:N})},[]),ee=(0,e.useCallback)(({target:{name:B,value:N}})=>{g({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:B,value:N})},[]);return e.createElement(ma,{value:{availableConditions:o.conditions,modifiedData:p,onChangeConditions:L,onChangeSimpleCheckbox:$,onChangeParentCheckbox:ee,onChangeCollectionTypeLeftActionRowCheckbox:y,onChangeCollectionTypeGlobalActionCheckbox:S}},e.createElement(V.TabGroup,{id:"tabs",label:h({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(V.Tabs,null,dr.map(B=>e.createElement(V.Tab,{key:B.id},h({id:B.labelId,defaultMessage:B.defaultMessage})))),e.createElement(V.TabPanels,{style:{position:"relative"}},e.createElement(V.TabPanel,null,e.createElement(io,{layout:l.collectionTypes,kind:"collectionTypes",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(io,{layout:l.singleTypes,kind:"singleTypes",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(ho,{layout:l.plugins,kind:"plugins",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(ho,{layout:l.settings,kind:"settings",isFormDisabled:t})))))});Wn.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},Wn.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const gr=(0,e.memo)(Wn)},92620:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!0},22438:(fe,D,a)=>{a.d(D,{Z:()=>e});const e=()=>"todo empty role"},2012:(fe,D,a)=>{a.d(D,{Z:()=>Je});var e=a(32735),E=a(60216),s=a.n(E),ne=a(9808),V=a.n(ne),Le=a(19192),Se=a.n(Le),Ce=a(53214),$e=a.n(Ce),X=a(95602),F=a.n(X),P=a(20763),Z=a.n(P),ge=a(484),U=a.n(ge),de=a(5636),Ye=Object.defineProperty,Qe=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,f=(ue,Y,re)=>Y in ue?Ye(ue,Y,{enumerable:!0,configurable:!0,writable:!0,value:re}):ue[Y]=re,we=(ue,Y)=>{for(var re in Y||(Y={}))Ge.call(Y,re)&&f(ue,re,Y[re]);if(Qe)for(var re of Qe(Y))Pe.call(Y,re)&&f(ue,re,Y[re]);return ue};const he=({id:ue,name:Y,description:re,usersCount:_e,icons:je})=>{const{formatMessage:ot}=(0,de.useIntl)(),He=ot({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:_e});return e.createElement(Ce.Tr,we({key:ue},(0,ge.onRowClick)({fn:je[1].onClick})),e.createElement(Ce.Td,{maxWidth:(0,ge.pxToRem)(130)},e.createElement(X.Typography,{ellipsis:!0,textColor:"neutral800"},Y)),e.createElement(Ce.Td,{maxWidth:(0,ge.pxToRem)(250)},e.createElement(X.Typography,{ellipsis:!0,textColor:"neutral800"},re)),e.createElement(Ce.Td,null,e.createElement(X.Typography,{textColor:"neutral800"},He)),e.createElement(Ce.Td,null,e.createElement(Le.Flex,we({justifyContent:"flex-end"},ge.stopPropagation),je.map((pe,et)=>pe?e.createElement(ne.Box,{key:pe.label,paddingLeft:et===0?0:1},e.createElement(P.IconButton,{onClick:pe.onClick,label:pe.label,noBorder:!0,icon:pe.icon})):null))))};he.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired};const Je=he},55520:(fe,D,a)=>{a.d(D,{Z:()=>ke});var e=a(32735),E=a(484),s=a(10186),ne=a(58469),V=a(59290),Le=a.n(V),Se=a(76470),Ce=a.n(Se),$e=a(95717),X=a.n($e),F=a(68192),P=a.n(F),Z=a(44526),ge=a(11856),U=a(53214),de=a(95602),Ye=a(16540),Qe=a(28004),Ge=a(5636),Pe=a(5141),f=a(2012),we=a(22438),he=a(60216),Je=a.n(he),ue=a(19615),Y=a(64410),re=a(54742),_e=a(20763),je=a(61541),ot=a(9808),He=a(19192),pe=a(90662),et=a(82372),at=a.n(et),se=a(94009),Ue=a.n(se);const x=a.p+"c3de6118ef47086ad05c.png",j=a.p+"bd81ba6c07827282255d.png",W=ue.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:w})=>(0,E.setHexOpacity)(w.colors.neutral800,.2)};
  padding: 0 ${({theme:w})=>w.spaces[8]};
`,ie=(0,ue.default)(He.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,q=(0,ue.default)(pe.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,G=(0,ue.default)(ot.Box)`
  position: absolute;
  right: ${({theme:w})=>w.spaces[4]};
  top: ${({theme:w})=>w.spaces[4]};
`,Q=({onClose:w,isOpen:k})=>{(0,E.useLockScroll)(k);const{formatMessage:z}=(0,Ge.useIntl)();return k?e.createElement(Y.Portal,null,e.createElement(W,{onClick:w},e.createElement(re.FocusTrap,{onEscape:w},e.createElement(ie,{onClick:le=>le.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:x,alt:"air-balloon"}),e.createElement(G,null,e.createElement(_e.IconButton,{onClick:w,"aria-label":"Close",icon:e.createElement(Ue(),null)})),e.createElement(q,{spacing:6},e.createElement(de.Typography,{fontWeight:"bold",textColor:"primary600"},z({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(pe.Stack,{spacing:2},e.createElement(de.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},z({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(de.Typography,null,z({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(je.LinkButton,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(at(),null)},z({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:j,alt:"upgrade-arrow"}))))):null};Q.propTypes={onClose:Je().func.isRequired,isOpen:Je().bool.isRequired};const _=Q;var H=a(55187);const oe=()=>{const{roles:w,isLoading:k}=(0,H.bF)(),z=(0,E.useQuery)(),le=decodeURIComponent(z.get("_q")||""),xe=(0,ne.ZP)(w,le,{keys:["name","description"]});return{isLoading:k,sortedRoles:xe}},Ne=()=>{const{formatMessage:w}=(0,Ge.useIntl)(),[k,z]=(0,e.useState)(!1),{trackUsage:le}=(0,E.useTracking)(),{push:xe}=(0,Pe.useHistory)(),ze=(0,e.useCallback)(Ae=>{xe(`/settings/roles/${Ae}`)},[xe]),qe=(0,e.useCallback)(()=>{z(Ae=>!Ae)},[]),J=(0,e.useCallback)(()=>{le("didShowRBACUpgradeModal"),z(!0)},[le]),ye=(0,e.useCallback)(Ae=>[{onClick:qe,label:w({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(P(),null)},{onClick:()=>ze(Ae.id),label:w({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(X(),null)},{onClick:qe,label:w({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Ce(),null)}],[w,qe,ze]);return{isModalOpen:k,handleToggleModalForCreatingRole:J,handleToggle:qe,getIcons:ye}},Ke=()=>{const{formatMessage:w}=(0,Ge.useIntl)();(0,E.useFocusWhenNavigate)();const{sortedRoles:k,isLoading:z}=oe(),{isModalOpen:le,handleToggle:xe,handleToggleModalForCreatingRole:ze,getIcons:qe}=Ne(),J=k.length+1,ye=5;return e.createElement(Ye.Main,null,e.createElement(E.SettingsPageTitle,{name:"Roles"}),e.createElement(ge.HeaderLayout,{primaryAction:e.createElement(Z.Button,{onClick:ze,startIcon:e.createElement(Le(),null),size:"S"},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:w({id:"global.roles",defaultMessage:"roles"}),subtitle:w({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(ge.ContentLayout,null,e.createElement(U.Table,{colCount:ye,rowCount:J,footer:e.createElement(U.TFooter,{onClick:ze,icon:e.createElement(Le(),null)},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(U.Thead,null,e.createElement(U.Tr,null,e.createElement(U.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.name",defaultMessage:"Name"}))),e.createElement(U.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.description",defaultMessage:"Description"}))),e.createElement(U.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.users",defaultMessage:"Users"}))),e.createElement(U.Th,null,e.createElement(Qe.VisuallyHidden,null,w({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(U.Tbody,null,k==null?void 0:k.map(Ae=>e.createElement(f.Z,{key:Ae.id,id:Ae.id,name:Ae.name,description:Ae.description,usersCount:Ae.usersCount,icons:qe(Ae)})))),!J&&!z&&e.createElement(we.Z,null)),e.createElement(_,{isOpen:le,onClose:xe}))},ke=()=>e.createElement(E.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(Ke,null))},19524:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=[]},94775:(fe,D,a)=>{a.d(D,{Z:()=>at});var e=a(32735),E=a(64213),s=a(484),ne=a(9808),V=a(44526),Le=a(11856),Se=a(78330),Ce=a(16540),$e=a(19192),X=a(90662),F=a(95602),P=a(37178),Z=a(90353),ge=a(98599),U=a.n(ge),de=a(83281),Ye=a(33795),Qe=a.n(Ye),Ge=a(86834),Pe=a.n(Ge),f=a(5636),we=a(5141),he=a(19615),Je=a(37926),ue=a(55187),Y=a(10186),re=a(5173);const je=re.Ry().shape({name:re.Z_().required(s.translatedErrors.required),description:re.Z_().required(s.translatedErrors.required)});var ot=a(98399),He=(se,Ue,x)=>new Promise((j,W)=>{var ie=Q=>{try{G(x.next(Q))}catch(_){W(_)}},q=Q=>{try{G(x.throw(Q))}catch(_){W(_)}},G=Q=>Q.done?j(Q.value):Promise.resolve(Q.value).then(ie,q);G((x=x.apply(se,Ue)).next())});const pe=he.default.div`
  border: 1px solid ${({theme:se})=>se.colors.primary200};
  background: ${({theme:se})=>se.colors.primary100};
  padding: ${({theme:se})=>`${se.spaces[2]} ${se.spaces[4]}`};
  color: ${({theme:se})=>se.colors.primary600};
  border-radius: ${({theme:se})=>se.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,et=()=>{const se=(0,s.useNotification)(),{lockApp:Ue,unlockApp:x}=(0,s.useOverlayBlocker)(),{formatMessage:j}=(0,f.useIntl)(),[W,ie]=(0,e.useState)(!1),{replace:q}=(0,we.useHistory)(),G=(0,e.useRef)(),{trackUsage:Q}=(0,s.useTracking)(),_=(0,we.useRouteMatch)("/settings/roles/duplicate/:id"),H=Qe()(_,"params.id",null),{isLoading:oe,data:Ne}=(0,ue.U_)(),{permissions:Ve,isLoading:Ke}=(0,ue.Dq)(H),rt=w=>{Ue(),ie(!0),Q(H?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,s.request)("/admin/roles",{method:"POST",body:w})).then(k=>He(void 0,null,function*(){const{permissionsToSend:z}=G.current.getPermissions();return Q(H?"didDuplicateRole":"didCreateNewRole"),k.data.id&&!Pe()(z)&&(yield(0,s.request)(`/admin/roles/${k.data.id}/permissions`,{method:"PUT",body:{permissions:z}})),k})).then(k=>{ie(!1),se({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),q(`/settings/roles/${k.data.id}`)}).catch(k=>{ot.error(k),ie(!1),se({type:"warning",message:{id:"notification.error"}})}).finally(()=>{x()})},ke=`${j({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,E.format)(new Date,"PPP")}`;return e.createElement(Ce.Main,null,e.createElement(s.SettingsPageTitle,{name:"Roles"}),e.createElement(de.Formik,{initialValues:{name:"",description:ke},onSubmit:rt,validationSchema:je,validateOnChange:!1},({handleSubmit:w,values:k,errors:z,handleReset:le,handleChange:xe})=>e.createElement(s.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(Le.HeaderLayout,{primaryAction:e.createElement(X.Stack,{horizontal:!0,spacing:2},e.createElement(V.Button,{variant:"secondary",onClick:()=>{le(),G.current.resetForm()},size:"L"},j({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(V.Button,{onClick:w,loading:W,size:"L"},j({id:"global.save",defaultMessage:"Save"}))),title:j({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:j({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(s.Link,{startIcon:e.createElement(U(),null),to:"/settings/roles"},j({id:"global.back",defaultMessage:"Back"}))}),e.createElement(Le.ContentLayout,null,e.createElement(X.Stack,{spacing:6},e.createElement(ne.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(X.Stack,{spacing:4},e.createElement($e.Flex,{justifyContent:"space-between"},e.createElement(ne.Box,null,e.createElement(ne.Box,null,e.createElement(F.Typography,{fontWeight:"bold"},j({id:"global.details",defaultMessage:"Details"}))),e.createElement(ne.Box,null,e.createElement(F.Typography,{variant:"pi",textColor:"neutral600"},j({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(pe,null,j({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(Se.Grid,{gap:4},e.createElement(Se.GridItem,{col:6},e.createElement(P.TextInput,{name:"name",error:z.name&&j({id:z.name}),label:j({id:"global.name",defaultMessage:"Name"}),onChange:xe,value:k.name})),e.createElement(Se.GridItem,{col:6},e.createElement(Z.Textarea,{label:j({id:"global.description",defaultMessage:"Description"}),name:"description",error:z.description&&j({id:z.description}),onChange:xe},k.description))))),!oe&&!Ke?e.createElement(ne.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(Je.Z,{isFormDisabled:!1,ref:G,permissions:Ve,layout:Ne})):e.createElement(ne.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(s.LoadingIndicatorPage,null))))))))};function at(){return e.createElement(s.CheckPagePermissions,{permissions:Y.Z.settings.roles.create},e.createElement(et,null))}},47594:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},65209:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},22609:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},37633:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},56388:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},10667:(fe,D,a)=>{a.d(D,{Z:()=>E});const E=!1},94289:(fe,D,a)=>{a.d(D,{Z:()=>Ue});var e=a(32735),E=a(484),s=a(10186),ne=a(59290),V=a.n(ne),Le=a(76470),Se=a.n(Le),Ce=a(68192),$e=a.n(Ce),X=a(95717),F=a.n(X),P=a(44526),Z=a(11856),ge=a(28004),U=a(16540),de=a(53214),Ye=a(95602),Qe=a(92891),Ge=a(58469),Pe=a(5636),f=a(5141),we=a(49986),he=a(55187),Je=a(22438),ue=a(2012),Y=a(49415);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},je=(x,j)=>(0,Y.default)(x,W=>{switch(j.type){case"ON_REMOVE_ROLES":{W.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{W.shouldRefetchData=!0,W.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{W.shouldRefetchData=!1,W.roleToDelete=null,W.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{W.roleToDelete=j.id;break}default:return W}});var ot=(x,j,W)=>new Promise((ie,q)=>{var G=H=>{try{_(W.next(H))}catch(oe){q(oe)}},Q=H=>{try{_(W.throw(H))}catch(oe){q(oe)}},_=H=>H.done?ie(H.value):Promise.resolve(H.value).then(G,Q);_((W=W.apply(x,j)).next())});const He=()=>{(0,E.useFocusWhenNavigate)();const{isLoading:x,allowedActions:{canCreate:j,canDelete:W,canRead:ie,canUpdate:q}}=(0,E.useRBAC)(s.Z.settings.roles),{getData:G,roles:Q,isLoading:_}=(0,he.bF)(!1),[{query:H}]=(0,E.useQueryParams)(),oe=(H==null?void 0:H._q)||"",Ne=(0,Ge.ZP)(Q,oe,{keys:["name","description"]});return(0,e.useEffect)(()=>{!x&&ie&&G()},[x,ie,G]),{isLoadingForPermissions:x,canCreate:j,canDelete:W,canRead:ie,canUpdate:q,isLoading:_,getData:G,sortedRoles:Ne,roles:Q}},pe=({getData:x,canCreate:j,canDelete:W,canUpdate:ie})=>{const{formatMessage:q}=(0,Pe.useIntl)(),G=(0,E.useNotification)(),[Q,_]=(0,e.useState)(!1),{push:H}=(0,f.useHistory)(),[{selectedRoles:oe,showModalConfirmButtonLoading:Ne,roleToDelete:Ve},Ke]=(0,e.useReducer)(je,re),rt=()=>ot(void 0,null,function*(){try{Ke({type:"ON_REMOVE_ROLES"}),yield we.be.post("/admin/roles/batch-delete",{ids:[Ve]}),yield x(),Ke({type:"RESET_DATA_TO_DELETE"})}catch(J){const ye=(0,Qe.get)(J,["response","payload","data","ids"],null);if(ye&&Array.isArray(ye)){const Ae=ye.join(`
`);G({type:"warning",message:Ae})}else G({type:"warning",message:{id:"notification.error"}})}z()}),ke=(0,e.useCallback)(J=>{H(`/settings/roles/duplicate/${J}`)},[H]),w=()=>H("/settings/roles/new"),k=(0,e.useCallback)(J=>{Ke({type:"SET_ROLE_TO_DELETE",id:J}),z()},[]),z=()=>_(J=>!J),le=(0,e.useCallback)(J=>{H(`/settings/roles/${J}`)},[H]),xe=(0,e.useCallback)((J,ye)=>{J.preventDefault(),J.stopPropagation(),ye.usersCount?G({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):k(ye.id)},[G,k]),ze=(0,e.useCallback)((J,ye)=>{J.preventDefault(),J.stopPropagation(),ke(ye.id)},[ke]),qe=(0,e.useCallback)(J=>[...j?[{onClick:ye=>ze(ye,J),label:q({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement($e(),null)}]:[],...ie?[{onClick:()=>le(J.id),label:q({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(F(),null)}]:[],...W?[{onClick:ye=>xe(ye,J),label:q({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Se(),null)}]:[]],[q,xe,ze,le,j,ie,W]);return{handleNewRoleClick:w,getIcons:qe,selectedRoles:oe,isWarningDeleteAllOpened:Q,showModalConfirmButtonLoading:Ne,handleToggleModal:z,handleDeleteData:rt}},at=()=>{const{formatMessage:x}=(0,Pe.useIntl)(),{isLoadingForPermissions:j,canCreate:W,canRead:ie,canDelete:q,canUpdate:G,isLoading:Q,getData:_,sortedRoles:H}=He(),{handleNewRoleClick:oe,getIcons:Ne,isWarningDeleteAllOpened:Ve,showModalConfirmButtonLoading:Ke,handleToggleModal:rt,handleDeleteData:ke}=pe({getData:_,canCreate:W,canDelete:q,canUpdate:G}),w=H.length+1,k=6;if(j)return e.createElement(U.Main,null,e.createElement(E.LoadingIndicatorPage,null));const z=x({id:"global.roles",defaultMessage:"roles"});return e.createElement(U.Main,null,e.createElement(E.SettingsPageTitle,{name:"Roles"}),e.createElement(Z.HeaderLayout,{primaryAction:W?e.createElement(P.Button,{onClick:oe,startIcon:e.createElement(V(),null),size:"S"},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:z,subtitle:x({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),ie&&e.createElement(Z.ActionLayout,{startActions:e.createElement(E.SearchURLQuery,{label:x({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:z})})}),ie&&e.createElement(Z.ContentLayout,null,e.createElement(de.Table,{colCount:k,rowCount:w,footer:W?e.createElement(de.TFooter,{onClick:oe,icon:e.createElement(V(),null)},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(de.Thead,null,e.createElement(de.Tr,null,e.createElement(de.Th,null,e.createElement(Ye.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.name",defaultMessage:"Name"}))),e.createElement(de.Th,null,e.createElement(Ye.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.description",defaultMessage:"Description"}))),e.createElement(de.Th,null,e.createElement(Ye.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.users",defaultMessage:"Users"}))),e.createElement(de.Th,null,e.createElement(ge.VisuallyHidden,null,x({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(de.Tbody,null,H==null?void 0:H.map(le=>e.createElement(ue.Z,{key:le.id,id:le.id,name:le.name,description:le.description,usersCount:le.usersCount,icons:Ne(le)})))),!w&&!Q&&e.createElement(Je.Z,null)),e.createElement(E.ConfirmDialog,{isOpen:Ve,onConfirm:ke,isConfirmButtonLoading:Ke,onToggleDialog:rt}))},Ue=()=>e.createElement(E.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(at,null))},49830:(fe,D,a)=>{a.d(D,{Z:()=>ne});var e=(V,Le,Se)=>new Promise((Ce,$e)=>{var X=Z=>{try{P(Se.next(Z))}catch(ge){$e(ge)}},F=Z=>{try{P(Se.throw(Z))}catch(ge){$e(ge)}},P=Z=>Z.done?Ce(Z.value):Promise.resolve(Z.value).then(X,F);P((Se=Se.apply(V,Le)).next())});const ne=[...strapi.features.isEnabled(strapi.features.SSO)?[{Component(){return e(this,null,function*(){return yield a.e(302).then(a.bind(a,43395))})},to:"/settings/single-sign-on",exact:!0}]:[]]}}]);
